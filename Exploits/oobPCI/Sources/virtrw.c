#include "virtrw.h"

uint64_t kread64(uint64_t kaddr)
{
	uint64_t outBuf;
	kreadbuf(kaddr, &outBuf, sizeof(outBuf));
	return outBuf;
}

uint32_t kread32(uint64_t kaddr)
{
	uint32_t outBuf;
	kreadbuf(kaddr, &outBuf, sizeof(outBuf));
	return outBuf;
}

uint16_t kread16(uint64_t kaddr)
{
	uint16_t outBuf;
	kreadbuf(kaddr, &outBuf, sizeof(outBuf));
	return outBuf;
}

uint8_t kread8(uint64_t kaddr)
{
	uint8_t outBuf;
	kreadbuf(kaddr, &outBuf, sizeof(outBuf));
	return outBuf;
}

void kwrite64(uint64_t kaddr, uint64_t val)
{
	kwritebuf(kaddr, &val, sizeof(val));
}

void kwrite32(uint64_t kaddr, uint32_t val)
{
	kwritebuf(kaddr, &val, sizeof(val));
}

void kwrite16(uint64_t kaddr, uint16_t val)
{
	kwritebuf(kaddr, &val, sizeof(val));
}

void kwrite8(uint64_t kaddr, uint8_t val)
{
	kwritebuf(kaddr, &val, sizeof(val));
}

uint64_t kread_ptr(uint64_t kaddr) {
    uint64_t ptr = kread64(kaddr);
    if ((ptr >> 55) & 1) {
        return ptr | 0xFFFFFF8000000000;
    }
    
    return ptr;
}
