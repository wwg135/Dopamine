#include <stdint.h>
#include <stdbool.h>
#include <mach/mach.h>

extern uint64_t cpuTTEP;

extern int (*physreadbuf)(uint64_t addr, void *buffer, size_t len);
extern int (*physwritebuf)(uint64_t addr, const void *buffer, size_t len);

// Fake phys r/w via virtual r/w
bool physread(uint64_t addr, size_t len, void *buffer);
bool physwrite(uint64_t addr, void *buffer, size_t len);

uint64_t rp64(uint64_t addr);
uint32_t rp32(uint64_t addr);
uint16_t rp16(uint64_t addr);
uint8_t  rp8(uint64_t addr);

uint64_t translateAddr_inTTEP(uint64_t ttep, uint64_t virt);
//uint64_t translateAddr(uint64_t virt);